<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CE313 - Estatística Não-Paramétrica - Módulo I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Modulo I/Aula 01/aula01.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
<meta property="og:title" content="CE313 - Estatística Não-Paramétrica - Módulo I">
<meta property="og:description" content="Material da disciplina CE313 - ESTATISTICA NÃO PARAMÉTRICA do curso de Estatística da Universidade Federal do Paraná (UFPR).">
<meta property="og:image" content="non-parametric.pngs">
<meta property="og:site_name" content="CE313 - Estatística Não-Paramétrica">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Modulo I/modulo-01.html">Módulo I</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">CE313 - Estatística Não-Paramétrica</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://raymz1990.github.io/CE313/tree/main/book/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../CE313---Estatística-Não-Paramétrica.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../CE313---Estatística-Não-Paramétrica.docx">
              <i class="bi bi-bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apresentação</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../Modulo I/modulo-01.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Módulo I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modulo I/Aula 01/aula01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Estatística Não Paramétrica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modulo I/Aula 02/aula02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estatísticas de ordem</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-modulo01" class="quarto-section-identifier">Módulo I</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Última atualização: 03 de agosto de 2018.</p>
</div>
</div>
<p>Sejam <span class="math inline">\(x_{1},  x_{2}, \cdots  x_{n}\)</span>, variáveis aleatórias independentes identicamente distribuídas com distribuição comum <span class="math inline">\(L(X)\)</span> e seja <span class="math inline">\(P\)</span> a classe de todas as possíveis distribuições de <span class="math inline">\(X\)</span> que consiste de todas as distribuições absolutamente contínuas ou discretas.</p>
<blockquote class="blockquote">
<p><strong>Definição</strong>. A estatística <span class="math inline">\(T(X)\)</span> é suficiente para a família de distribuições <span class="math inline">\(P\)</span> se a distribuição condicional de <span class="math inline">\(X|T=t\)</span> é a mesma, seja qual for a função de distribuição <span class="math inline">\(F∈P\)</span>.</p>
</blockquote>
<p><strong>Exemplo</strong>. Sejam <span class="math inline">\(x_{1},  x_{2}, \cdots  x_{n}\)</span> variáveis aleatórias independentes igualmente distribuídas com distribuição absolutamente contínua e seja <span class="math inline">\(T = (X_{(1)}, \cdots, X_{(n)})\)</span> a estatística de ordem. Então: <span class="math display">\[f(x|T = t) = 1n!,\]</span> e vemos que <span class="math inline">\(T\)</span> é uma estatística suficiente para a família das distribuições absolutamente contínuas.</p>
<p>Definição. A família de distribuições P é completa se somente a função zero for o estimador não viesado de 0, isto é, EF(h(X))=0, para todo F∈P implica que h(X)=0 . Isto para todo x exceto para um conjunto nulo em relação a cada F∈P .</p>
<p>Exemplo. Seja X∼Uniforme(0,θ) , onde θ∈(0,∞) . Mostraremos que esta família de distribuições é completa. Precisamos mostrar que Eθ(g(X))=∫θ0g(x)1θdx=0,∀θ&gt;0, se, e somente se, g(x)=0 , para todo x . Em geral, esse resultado segue a teoria da integração. Se g for contíua, diferenciamos ambos os lados de ∫θ0g(x)dx=0, para obter g(θ)=0 , para todo θ&gt;0 . Agora, seja X1,X2,⋯,Xn uma amostra aleatória da distribuição Uniforme(0,θ) . Também, seja X(n)=max(X1,X2,⋯,Xn) . Então, a função de densidade de X(n) é dada por fX(n)(x|θ)=nθ−nxn−1,0&lt;x&lt;θ, zero caso contrário. Vemos por um argumento semelhante que X(n) é completa, o que é o mesmo do que dizer que {fX(n)(x|θ);θ&gt;0} é uma família de densidades completa. Claramente X(n) é suficiente.</p>
<p>Definição. Uma estatística T(X) é dita ser completa em relação a uma classe de distribuições P se a classe de distribuições induzidas de T for completa.</p>
<p>Claro que todos os exemplos já encontrados de estatísticas completas ou famílias completas de distribuições para o caso paramétrico podem ser aplicados nesta situação.</p>
<p>Teorema. A estatística de ordem (X(1),⋯,X(n)) é uma estatística suficiente e completa desde que a amostra X1,X2,⋯,Xn seja composta de variáveis aleatórias independentes identicamente distribuídas do tipo discreta ou contínua. Demonstração Ver Fraser (1965).▉</p>
<p>Definição. Diz-se que uma função real g(F) é estimável se tiver um estimador não viciado, isto é, se existe uma estatística T(X) tal que EF(T(X))=g(F), para todo F∈P .</p>
<p>Exemplo. Se P é a classe de todas as distribuições para as quais o segundo momento existe, X é um estimador não viciado de μ(F) , a média da população. Similarmente μ2(F)=VarF(X), é também estimável e um estimador não viciado é S2=1n−1∑i=1n(Xi−X¯¯¯¯)2⋅ Da mesma forma, X¯¯¯¯−Y¯¯¯¯ é um estimador não viciado de E(X)−E(Y) , 1n{número de X&gt;c} é um estimador não viciado de PF(X&gt;c) e assim por diante.</p>
<p>Definição. O grau m , m≥1 , de um parâmetro estimável g(F) é o menor tamanho de amostra para o qual o parâmetro é estimável, ou seja, é o menor n para o qual existe um estimador não viciado T(X1,⋯,Xn) com EF(T(X))=g(F), para todo F∈P .</p>
<p>Exemplo. O parâmetro g(F)=PF(X&gt;c), onde c é uma constante conhecida, têm grau 1. Também μ(F) é estimável com grau 1, para isto assumimos que existe ao menos um F∈P tal que μ(F)≠0 . Acontece que μ2(F) é estimável com grau 2, desde que μ2(F) não seja estimável de forma não viciada por somente uma observação. Ao menos duas observações são necessárias. De maneira similar, μ2(F) têm grau 2.</p>
<p>Definição. Um estimador não viciado de algum parâmetro baseado no tamanho mínimo de amostra, ou seja, com amostra iagual ao grau m é chamado de kernel.</p>
<p>Exemplo. Seja X1,⋯,Xn uma amostra aleatória com distribuição F . Então Xi é o kernel de μ(F) ; XiXj , i≠j , é o kernel de μ2(F) e cada T(Xi,Xj)=X2i−XiXj,i=1,⋯,n,i≠j, é kernel de μ2(F) .</p>
<p>Teorema. Existe um kernel simétrico para cada parâmetro estimável. Demonstração Seja T(X1,⋯,Xm) um kernel para g(F) . Também é Ts(X1,⋯,Xm)=1m!∑PT(Xi1,Xi2⋯,Xim) um kernel para g(F) , onde a soma P acontece sobre todas as m! permutacoes de {1,2,⋯,m} .▉</p>
<p>Exemplo. Seja X1,⋯,Xn uma amostra aleatória com distribuição F . Um kernel simétrico para μ2(F) é Ts(Xi,Xj)=12(T(Xi,Xj)+T(Xj,Xi))=12(Xi−Xj)2,i=1,⋯,n,i≠j⋅</p>
<p>Definição. Seja g(F) um parâmetro estimável de grau m e X1,X2,⋯,Xn uma amostra aleatória de F de tamanho n , n≥m . Correspondendo a qualquer kernel T(X1,⋯,Xn) de g(F) , definimos a U-estatística para a amostra como U(X1,X2,⋯,Xn)=1(nm)∑CTs(Xi1,Xi2,⋯,Xin), onde o índice da soma C percorre todas as (nm) permutações de m inteiros (i1,i2,⋯,im) escolhidos de {1,2,⋯,n} e Ts é um kernel simétrico, como definido na demonstração do Teorema anterior.</p>
<p>Claramente, a U-estatística definida é simétrica nos X e EF(U(X))=g(F), para todo F .</p>
<p>Exemplo. Seja X1,⋯,Xn uma amostra aleatória com distribuição F . Para estimarmos μ(F) a U-estatística é dada por U(X1,X2,⋯,Xn)=1n∑i=1nXi⋅ Para estimarmos μ2(F) , um kernel simétrico é Ts(Xi1,Xi2)=12(Xi1−Xi2)2, para i1=1,2,⋯,n , i1≠i2 . A correspondente U-estatística é U(X)=1(n2)∑i1&lt;i212(Xi1−Xi2)2=1n−1∑i=1n(Xi−X¯¯¯¯)2=S2⋅</p>
<p>De maneira similar, para estimarmos μ2(F) , o kernel simétrico é Ts(Xi1,Xi2)=Xi1Xi2 e a correspondente U-estatística é U(X)=1(n2)∑i&lt;jXiXj=1n(n−1)∑i≠jXiXj⋅ Para estimarmos μ3(F) um kernel simétrico seria Ts(Xi1,Xi2,Xi3)=Xi1Xi2Xi3 , sendo que a U-estatística é U(X)=1(n3)∑i&lt;j&lt;kXiXjXk=1n(n−1)(n−2)∑i≠j≠kXiXjXk⋅ O seguinte resultado mostra a importância da U-estatística.</p>
<p>Teorema. Seja P a classe de todas as distribuições absolutamente contínuas ou discretas. Qualquer função estimável g(F) , F∈P , tem um estimador único que é não viciado, simétrico nas observações e uniformemente de variância mínima entre todos os estimadores não viciados. Demonstração Seja X1,⋯,Xn uma amostra aleatória de F , F∈P e seja T(X1,⋯,Xn) um estimador não viciado de g(F) . Considere o conjunto de todas as n! permutações de {1,2,⋯,n} e indexá-los adequadamente. Seja {i1,i2,⋯,in} o i-ésimo deste conjunto e seja Ti=Ti(X1,X2,⋯,Xn)=T(Xi1,Xi2⋯,Xin),i=1,2,⋯,n!⋅ Seja T¯¯¯¯=1n!∑i=1n!Ti⋅ Claro que E(T)=g(F) e Var(T¯¯¯¯)=≤E(1n!∑n!i=1Ti)2−(g(F))2E(1(n!)2∑n!i=1T2i)−(g(F))2=E(T2)−(g(F))2=Var(T)⋅ A igualdade se mantém se, e somente se, Ti(X1,X2,⋯,Xn)=αn!,i=1,2,⋯,n!, para todos os pontos no espaço amostral, exceto talvez para um conjunto nulo, em que α é uma constante. Segue-se que T(X) é simétrico nos argumentos X1,X2,⋯,Xn com probabilidade 1 e T¯¯¯¯ é idêntico a T . A exclusividade é deixada como exercício.▉</p>
<p>Teorema. Seja T(X1,⋯,Xn) um estimador não viciado para g(F) , F∈P . A correspondente U-estatística é essencialmente o único estimador não viciado uniformemente de mínima variância. Demonstração Consequência do teorema anterior.▉</p>
<p>De acordo com os teoremas acima precisamos apenas considerar estimadores que sejam simétricos nas observações e tudo o que devemos fazer é torná-las não viciados. Este procedimento leva a um estimador não viciado com a menor variância na classe de todos os estimadores não viciados do parâmetro. Por exemplo, como consequência destes teoremas, X¯¯¯¯ e S2 são os únicos estimadores não viciados uniformemente de variância mínima de μ(F) e μ2(F) , respectivamente.</p>
<p>Exemplo. Seja P a classe de todas as distribuições absolutamente contínuas e X1,X2,⋯,Xn uma amostra aleatória de tamanho n . Para estimarmos g(F)=PF(X1&gt;c), onde c é uma constante fixa, definimos Yi={1,0,Xi&gt;c,Xi≤ci=1,2,⋯,n⋅ Considere agora T(Y1,Y2,⋯,Yn)=∑i=1nαiYi, como um estimador de g(F) . Para encontrar o estimador não viciado de mínima variância de g simetrizamos T nos Y1,Y2,⋯,Yn . Isso acontece se αi=α , i=1,2,⋯,n e T(Y)=α∑ni=1Yi . Para T ser não viciado, temos que EF(T)=α∑i=1nEF(Yi)=αng(F), de maneira que α=1n . Portanto, 1n∑ni=1Yi é o estimador não viciado de mínima variância; também VarF(T)=g(F)(1−g(F))n≤14n⋅ Além disso, Yi têm distribuição Bernoulli , de modo a 1n(T−g(F))(g(F)(1−g(F)))12⟶DZ,n→∞, onde Z∼N(0,1) . Este resultado pode ser usado para encontrar limites de confiança em g(F) .</p>
<p>Seja P a classe de todas as distribuições absolutamente contínuas na reta real. Sejam F,G∈P e definamos a função distância Δ(F,G) como segue: Δ(F,G)=∫∞−∞(F(x)−G(x))2F′(x)+G′(x)2dx⋅ Esta função satisfaz as seguintes propriedades:</p>
<p>Δ(F,G)=0 se, e somente se, F=G . Δ(F,G)=Δ(G,F) . Δ(F,G)&gt;0 . Por outro lado, vamos supor que F(x)≠G(x) para algum x1 , onde F(x1)−G(x1)=d&gt;0 . Dado que F e G são distribuições absolutamente contínuas, existe um x0&lt;x1 , tal que F(x0)−G(x0)=d2eF(x)−G(x)≥d2, para x0≤x≤x1 . Dado que tanto F quanto G são ambas não decrescentes, pelo menos um dos F e G deve aumentar pelo menos d/2 quando x varia de x0 a x1 . Então Δ(F,G)≥∫x1x0(F(x)−G(x))2F′(x)+G′(x)2dx≥(d2)2d/22&gt;0⋅ Exemplo. Encontremos um estimador não viciado de mínima variância para Δ(F,G) . Sejam X1,X2,⋯,Xm uma amostra aleatória de F e Y1,Y2,⋯,Yn uma amostra aleatória de G , independentes. Consideramos que F,G∈P . Primeiro mostramos que g(F,G)=P({max(X1,X2)&lt;min(Y1,Y2)}⋃{max(Y1,Y2)&lt;min(X1,X2)})=13+2Δ(F,G)⋅ Temos que g(F,G)=P({max(X1,X2)&lt;min(Y1,Y2)})+P({max(Y1,Y2)&lt;min(X1,X2)}) e P(max(X1,X2)≤x)=F2(x),P(min(Y1,Y2)≥y)=[1−G(y)]2⋅ Então g(F,G)======∫∞−∞[1−G(y)]22F(y)F′(y)dy+∫∞−∞[1−F(x)]22G(x)G′(x)dx∫∞−∞[1+G2(y)−2G(y)]2F(y)F′(y)dy+∫∞−∞[1+F2(x)−2F(x)]2G(x)G′(x)dx2+∫∞−∞2[G2(x)F(x)F′(x)+F2(x)G(x)G′(x)−2F(x)G(x)(F′(x)+G′(x))]dx3−2∫∞−∞((F(x)+G(x))2−(F(x)−G(x))2)(F′(x)+G′(x)2)dx3−8∫∞−∞(F(x)+G(x)2)2(F′(x)+G′(x)2)dx+2Δ(F,G)3−83+2Δ(F,G)=g(F,G)⋅ Para utilizarmos os teoremas acima, vamos definir φ(X1,X2,Y1,Y2)={1,0,se max(X1,X2)&lt;min(Y1,Y2) ou se max(Y1,Y2)&lt;min(X1,X2)caso contrário Então φ(X1,X2,Y1,Y2) é um estimador não viciado de g(F,G) e de fato é um kernel de g(F,G) . A U-estatística correspondente, portanto, deve ser o estimador não viciado de mínima variância. Nós temos U(X,Y)=1(m2)(n2)∑i1&lt;i2∑k1&lt;k2φ(Xi1,Xi2,Yk1,Yk2), de maneira que U é o estimador não viciado de mínima variância de g(F,G) , assim como o estimador não viciado de mínima variância de Δ(F,G) é Δˆ(F,G)=12U(X,Y)−16⋅</p>
<p>Exemplo. Seja P a classe de todas as funções de distribuição absolutamente contínuas na reta real e X1,X2,⋯,Xm e Y1,Y2,⋯,Yn duas amostras aleatórias independentes de F e G , respectivamente, com F,G∈P . Queremos estimar ρ(F,G)=P(X&lt;Y)⋅ Com esse objetivo, vamos definir Zij={1,0,Xi&lt;YjXi≥Yj para cada par Xi,Yj , i=1,2,⋯,m e j=1,2,⋯,n . Então ∑i=1mZij é o número de vezes que X&lt;Yj e ∑j=1nZij é o número de vezes que Xi&lt;Y . Mann and Whitney (1947) sugeriram utilizar o estimador U/mn , onde U=∑i=1m∑j=1nZij e E(U)=mnE(Zij)=mnP(X&lt;Y)⋅ Então ρˆ(F,G)=Umn, é não viciado para ρ . Além disso, ρˆ é simétrico em X e Y , de modo que tem uma variância mínima. Para calcular a variância mínima, temos E(U2)=∑i∑j∑h∑kE(ZijZhk), onde ZijZhk={1,0,se Xi&lt;Yj e Xh&lt;Ykcaso contrário, de modo a E(ZijZhk)=P(Xi&lt;Yj,Xh&lt;Yk)=⎧⎩⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪∫F(x)G′(x)dx,∫(1−G(x))2F′(x)dx,∫F2(x)G′(x)dx,(∫F(x)G′(x)dx)2, caso i=h,j=k caso i=h,j≠k caso i≠h,j=k caso i≠h,j≠k⋅ Há mn termos com i=h,j=k ; m(m−1)n termos com i≠h,j=k ; mn(n−1) termos com i=h,j≠k e m(m−1)n(n−1) termos com i≠h,j≠k . Segue que E(U2)=mn∫F(x)G′(x)dx+mn(n−1)∫(1−G(x))2F′(x)dx+m(m−1)n∫F2(x)G′(x)dx+m(m−1)n(n−1)(∫F(x)G′(x)dx)2, que leva à variância de U . Em particular, se F=G , então Var(U)=mn(m+n+1)12⋅</p>
<p>I.1 Estimação de densidades</p>
<p>De certa forma, problemas de estimação não-paramétrica são extensões de problemas de estimação paramétrica, mas a natureza do primeiro é bem diferente do último. Considere, por exemplo, a situação de observações independentes identicamente distribuídas, digamos X1,X2,⋯,Xn . Em um problema paramétrico, assumimos que a distribuição de Xi é F(⋅;θ) , a qual é totalmente especificada até o vetor de parâmetros θ ; então o problema é essencialmente a estimaçã de θ . Em um problema não-paramétrico, a distribuição é totalmente desconhecida com, talvez, algumas restriçõs em propriedades gerais e, portanto, é denotada por F .</p>
<p>Aqui consideramos estimadores de F em termos de função de densidade f . A função de densidade tem a vantagem de fornecer uma representação visualmente mais informativa da distribuição subjacente. Por exemplo, o histograma geralmente dá uma ideia aproximada da forma da distribuição. Este último ficou como o único estimador de densidade não paramétrico até 1950. Por essa razão, nossa discussão começará com os histogramas.</p>
<p>Embora o histograma seja usado extensivamente, não é tão frequente que seja necessária uma definição matemática. Uma maneira de defini-lo é através da função de densidade empírica.</p>
<p>Definição. Seja f a derivada de F ; por isso pode-se expressar como f(x)=limh→0F(x+h)−F(x−h)2h⋅ Então, dizemos que fˆ , definido por fˆ(x)=Fˆ(x+h)−Fˆ(x−h)2h, é o histograma, sendo que Fˆ é a função de distribuição empírica.</p>
<p>O parâmetro h é chamado de largura de banda. Podemos escrever fˆ , definido acima como, fˆ(x)=12nh∑i=1n11(x−h;x+h)(Xi)⋅ Podemos excrever a função de densidade como f(x)=limh→01h(F(x+h)−F(x−h)) , mas não se pode definir daqui o histograma porque, então, esse limite é zero ou infinito e assim em algum momento é preciso parar, em outras palavras, não se pode chegar muito perto de zero.</p>
<p>Teorema. Seja f a função de densidade da função de distribuição F . Então, com probabilidade 1, fˆ(x)∼Binomial(n,p), com p=F(x+h)−F(x−h) . Assim, o comportamento assintótico do histograma pode ser derivado da distribuição binomial como E(fˆ(x))=F(x+h)−F(x−h)2h e Var(fˆ(x))=p(1−p)4nh2⋅ Demonstração. Exercício.▉</p>
<p>Deste teorema segue que fˆ(x) é um estimador consistente pontual de f(x) quando h→0 e nh→∞ . A seguir, o processo de limite é entendido como h=hn , de maneira que hn→0 e nhn→∞ . Estas condições podem ser interpretadas como se fosse necessário hn ir a zero, mas não muito rápido. Isso é exatamente o que temos especulado, exceto que agora temos a taxa exata de convergência, que pode ser escrita como hn=o(n) .</p>
<p>Exemplo. Utilaremos dados simulados da distribuíão N(0,1) , com isso mostramos o histograma destes 50 dados utilizando duas formas diferentes de encontrarmos uma expressão para hn , a chamada largura de banda.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1340</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">"Sturges"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modulo-01_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">"Scott"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modulo-01_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Neste exemplo utilizamos duas formas de escolher a largura de banda hn dentre três diferentes possibilidades programadas na função hist. Por padrão escolhe-se breaks = “Sturges”, porposto por Sturges (1929), o qual sugere que hn=max(X1,⋯,Xn)−min(X1,⋯,Xn)1+3.322ln(n)⋅ A segunda situação indica que o qual significa que se os dados provêm da distribuição Normal temos que hn=3.49sn−1/3 sendo s o desvio padrão estimado. Esta proposta deve-se à Scott (1979).</p>
<p>Embora o histograma é um estimador consistente quando hn→0 e nhn→∞ , verifica-se que se pode fazer melhor. A melhoria também é motivada por uma preocupação prática: o histograma não é uma função suave, uma propriedade que se pode esperar que qualquer função de densidade real tenha.</p>
<p>Definição. O estimador kernel da função de densidade é dado por fˆ(x)=1nhn∑i=1nK(x−Xihn), onde K(⋅) é uma função conhecida como kernel.</p>
<p>É tipicamente assumido que K seja não-negativa, simétrica em torno de zero e satisfaz ∫K(u)du=1 . Claro que o histograma é um caso especial do estimador do kernel se K for escolhido como a função de densidade da distribuição Uniforme(−1,1) . O último não é uma função suave e é por isso que o histograma não é suave; mas escolhendo K como uma função suave, tem-se um estimador de f que seja suave.</p>
<p>Por exemplo, escolhendo a função de densidade N(0,1) , temos por resultado o conhecido como kernel Gaussiano e assim também utilizando a densidade de densidade Beta simétrica, dada por K(u)=Γ(ν+3/2)Γ(1/2)Γ(ν+1)(1−u2)ν,−1&lt;u&lt;1, e K(u)=0 caso contrário. Os casos especiais ν=0,1,2,3 correspondem às funções kernel uniforme, Epanechnikov, biweight e triweight, respectivamente.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Diferentes kernel em R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Larguras de banda equivalentes</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>kernels <span class="ot">=</span> <span class="fu">eval</span>(<span class="fu">formals</span>(density.default)<span class="sc">$</span>kernel)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (<span class="fu">density</span>(<span class="dv">0</span>, <span class="at">bw =</span> <span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">"Diferentes kernel em R"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(kernels)) <span class="fu">lines</span>(<span class="fu">density</span>(<span class="dv">0</span>, <span class="at">bw =</span> <span class="dv">1</span>, <span class="at">kernel =</span>  kernels[i]), <span class="at">col =</span> i)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">1.5</span>,.<span class="dv">4</span>, <span class="at">legend =</span> kernels, <span class="at">col =</span> <span class="fu">seq</span>(kernels), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> .<span class="dv">8</span>, <span class="at">y.intersp =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modulo-01_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>h.f <span class="ot">=</span> <span class="fu">sapply</span>(kernels, <span class="cf">function</span>(k) <span class="fu">density</span>(<span class="at">kernel =</span> k, <span class="at">give.Rkern =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>h.f <span class="ot">=</span> (h.f[<span class="st">"gaussian"</span>] <span class="sc">/</span> h.f)<span class="sc">^</span> .<span class="dv">2</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>h.f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    gaussian epanechnikov  rectangular   triangular     biweight       cosine 
   1.0000000    1.0100567    0.9953989    1.0071923    1.0088217    1.0079575 
   optcosine 
   1.0099458 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> <span class="fu">bw.SJ</span>(x) <span class="do">## escolha automática</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> bw), <span class="at">main =</span> <span class="st">"Larguras de banda equivalentes"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(kernels)) <span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> bw, <span class="at">adjust =</span> h.f[i], </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">kernel =</span> kernels[i]), <span class="at">col =</span> i)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">55</span>, <span class="fl">0.035</span>, <span class="at">legend =</span> kernels, <span class="at">col =</span> <span class="fu">seq</span>(kernels), <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modulo-01_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Um problema prático importante na estimação de densidades via kernel é como escolher a largura de banda hn . Note que dadas condições como hn→0 e nhn→∞ , ainda existem muitas opções para hn . Então, de certo modo, a ordem de convergência ou divergência não resolve o problema. Uma solução para esse problema é conhecida como compensação de viés-variância. Antes de entrarmos nos detalhes, vamos primeiro apressentar um resultado em relação ao viés assintótico do estimador kernel. Aqui, o viés é definido como viés(fˆ(x))=E(fˆ(x))−f(x), para um dado x .</p>
<p>Teorema. Suponhamos que f seja contínua e limitada. Então o viés do estimador kernel de densidade converge a zero quando hn→0 , para todo x . Demonstração. Observemos que E(fˆ(x))==1n∑ni=11hn∫K(x−yhn)f(y)dy∫K(u)f(x−hnu)du=f(x)+∫K(u)(f(x−hnu)−f(x))du⋅ Utilizando então o teorema da convergência dominada completa-se a demonstração.▉</p>
<p>Teorema. Suponhamos que f seja contínua três vezes diferenciável, com terceira derivada limitada na vizinhança de x e K satisfazendo ∫K2(u)du&lt;∞e∫|u|3K(u)du&lt;∞⋅ Se hn→0 quando n→∞ , temos que viés(fˆ(x))=h2n2f′′(x)∫u2K(u)du+o(h2n)⋅ Se, além disso nhn→∞ quando n→∞ , então temos Var(fˆ(x))=f(x)nhn∫K2(u)du+o((nhn)−1)⋅ Demonstração. A demonstração é baseada na expansão de Taylor, f(x−hnu)=f(x)−hnuf′(x)+h2nu22f′′(x)−h3nu36f′′′(ϵ), sendo ϵ fica entre x−hnu e x . Os detalhes são deixados como um exercício.▉</p>
<p>Uma medida de precisão do estimador é o erro quadrático médio (EQM), dado por EQM(fˆ(x))=E(fˆ(x)−f(x))2⋅ É fácil mostrar que o EQM combina o viés e a variância de tal maneira que EQM(fˆ(x))=viés(fˆ(x))2+Var(fˆ(x))⋅ Vemos que, sob as condiçotilde;es hn→0 e nhn→∞ e se ignorarmos os termos de baixa ordem, temos EQM(fˆ(x))≈h4n4(f′′(x))2τ4+f(x)nhnγ2, onde τ2=∫u2K(u)du e γ2=∫K2(u)du . O termo à direita da expressão acima é minimizada quando hn=(γ2f(x)τ4(f′′(x))2)15n−15⋅ Note ainda que a expressão acima não é a solução ideal, isso porque f é desconhecida na prática. No entanto, dá-nos pelo menos alguma ideia sobre a taxa ideal de convergência a zero, sendo esta hn=O(n−15) .</p>
<p>Quando f é desconhecida, uma abordagem natural seria substituí-lo por um estimador e, assim, obter uma largura de banda ideal estimada. Uma complicação é que a largura de banda ideal depende de x mas, idealmente, gostaríamos de usar uma largura de banda que funcionasse para diferentes x dentro de um certo intervalo, se não todos os x . Para obter uma largura de banda ideal que não depende de x , integramos os dois lados da expressão de EQM em relação a x . Isto nos leva a ∫EQM(fˆ(x))dx≈τ4h4n4∫(f′′(x))2dx+γ2nhn∫f(x)dx=τ4θ2h4n4+γ2nhn, com θ2=∫(f′′(x))2dx . Pelo mesmo argumento, o lado direito acima é minimizado quando hn=(γ2τ4θ2)15n−15⋅ Desta vez, o hn ideal não depende de x . Além disso, a integral do EQM ou o IEQM mínimo é dado por IEQM=∫EQM(fˆ(x))dx=54(τγ2)45θ25n−45⋅ Uma implicação é a seguinte. Note que o IEQM depende do kernel K através de cK=(τγ2)45 . Mostrou-se que para os kernels comumente usados, tais como aqueles listados, o desempenho dos estimadores de kernel correspondentes é quase o mesmo em termos dos valores de cK . Voltando ao problema sobre a estimação da largura de banda ideal, vemos que tudo o que precisamos é encontrar um estimador consistente de θ2 . Se f é a função de densidade da distribuição normal com desvio padrão σ , então pode ser mostrado que θ2=3/8π−−√σ5 . Naturalmente, se alguém souber que f é normal, então a estimação da densidade não-paramétrica não seria necessária, porque um método paramétrico provavelmente seria melhor. Em geral, pode-se expandir f em torno da densidade gaussiana usando a expansão de Edgeworth.</p>
<p>Utilizando a abordagem acima, Hjort and Jones (1996) obteveram o seguinte estimador ótimo para a largura de banda hˆn=hˆ0(1+3548γˆ4+3532γˆ23+3851024γˆ24)−15, onde hˆ0 é a estimativa ideal da largura de banda assumindo que f é normal, isto é, com θ2 substituído por 3/8π−−√σ5 ou mais explicitamente hˆ0=1.06(σˆn15), chamamos hˆ0 a largura de banda da linha de base e σˆ2 é a variância amostral dada por σˆ2=1n−1∑i=1n(Xi−X¯¯¯¯)2⋅ Além disso, γˆ3 e γˆ4 são os estimadores dos coefcientes de assimetria de amostra e curtose, dado por γˆ3=1(n−1)σˆ3∑i=1n(Xi−X¯¯¯¯)3 e γˆ4=1(n−1)σˆ4∑i=1n(Xi−X¯¯¯¯)4−3, respectivamente. Houve outras abordagens para a seleção da largura de banda ótima, incluindo o método de validação cruzada. Ambos procedimentos foram programados na função density.</p>
<p>Exemplo. Utilaremos os dados simulados da distribuíão N(0,1) no exemplo anterior para com isso mostrarmos o histograma e o estimador Kernel da função de densidade.</p>
<blockquote class="blockquote">
<p>set.seed(1340) x = rnorm(50) par(mar=c(4,2,1,1)) hist(x, main = NULL, freq = FALSE, breaks = “Sturges”) box() lines(density(x, bw = “nrd0”), col = “red”) par(mar=c(4,2,1,1)) hist(x, main = NULL, freq = FALSE, breaks = “Scott”) box() lines(density(x, bw = “bcv”), col = “red”)</p>
</blockquote>
<p>I.2 Exercícios Seja T(X1,⋯,Xn) uma estatística simétrica nas observaçóes. Mostre que T pode ser escrita como função das estatísticas de ordem. Por outro lado, se T(X1,⋯,Xn) pode ser escrita como função das estatísticas de ordem, T é simétrica nas observações.</p>
<p>Sejam X1,X2,⋯,Xm e Y1,Y2,⋯,Yn amostras independentes de duas distribuições absolutamente contínuas. Encontre o estimador não viciado de mínima variância de: (a) E(XY)</p>
<ol start="2" type="a">
<li>Var(X+Y)</li>
</ol>
<p>Seja (X1,Y1),(X2,Y2),⋯,(Xn,Yn) uma amostra aleatória com distribuição absolutamente contínua bivariada. Encontre o estimador não viciado de mínima variância de: (a) E(XY)</p>
<ol start="2" type="a">
<li>Var(X+Y)</li>
</ol>
<p>Cosidere (R,B,Pθ) um espaço de probabilidade e P={Pθ:θ∈Θ} . Seja A um elemento da σ -álgebra de Borel e considere d(θ)=Pθ(A) . (a) A função d é estimável? Se sim, qual é o grau? (b) Encontre o estimador não viciado de mínima variância de d , baseado em uma amostra de tamanho n e assumindo que P seja a classe de todas as distribuições contínuas.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link  aria-label=" apresentação"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Apresentação</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Modulo I/Aula 01/aula01.html" class="pagination-link" aria-label="<span class='chapter-number'>1</span>&nbsp; <span class='chapter-title'>Estatística Não Paramétrica</span>">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Estatística Não Paramétrica</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Estatística 2023-2026</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions"><ul><li><a href="https://raymz1990.github.io/CE313/edit/main/book/Modulo I/modulo-01.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://raymz1990.github.io/CE313/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>