<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-03-13">

<title>CE313 - Estatística Não-Paramétrica - 5&nbsp; Estimação de Densidades</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../ModuloII/index.html" rel="next">
<link href="../../ModuloI/Aula04/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../custom.css">
<meta property="og:title" content="CE313 - Estatística Não-Paramétrica - 5&nbsp; Estimação de Densidades">
<meta property="og:description" content="Material da disciplina CE313 - ESTATISTICA NÃO PARAMÉTRICA do curso de Estatística da Universidade Federal do Paraná (UFPR).">
<meta property="og:image" content="non-parametric.pngs">
<meta property="og:site_name" content="CE313 - Estatística Não-Paramétrica">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../ModuloI/index.html">Módulo I</a></li><li class="breadcrumb-item"><a href="../../ModuloI/Aula05/index.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimação de Densidades</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">CE313 - Estatística Não-Paramétrica</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://raymz1990.github.io/CE313/tree/main/book/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../../CE313---Estatística-Não-Paramétrica.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../../CE313---Estatística-Não-Paramétrica.docx">
              <i class="bi bi-bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apresentação</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ModuloI/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Módulo I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ModuloI/Aula01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Estatística Não Paramétrica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ModuloI/Aula02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estatísticas de Ordem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ModuloI/Aula03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estatística Não Paramétrica 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ModuloI/Aula04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Função de Distribuição Empírica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ModuloI/Aula05/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimação de Densidades</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ModuloII/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Módulo I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ModuloII/Aula07/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">index.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#função-de-densidade-empírica." id="toc-função-de-densidade-empírica." class="nav-link active" data-scroll-target="#função-de-densidade-empírica."><span class="header-section-number">5.1</span> Função de densidade empírica.</a></li>
  <li><a href="#histograma-informalmente" id="toc-histograma-informalmente" class="nav-link" data-scroll-target="#histograma-informalmente"><span class="header-section-number">5.2</span> Histograma, informalmente</a></li>
  <li><a href="#histograma" id="toc-histograma" class="nav-link" data-scroll-target="#histograma"><span class="header-section-number">5.3</span> Histograma</a>
  <ul class="collapse">
  <li><a href="#cálculo-automático-do-número-de-intervalos-num-histograma" id="toc-cálculo-automático-do-número-de-intervalos-num-histograma" class="nav-link" data-scroll-target="#cálculo-automático-do-número-de-intervalos-num-histograma"><span class="header-section-number">5.3.1</span> Cálculo automático do número de intervalos num histograma</a></li>
  </ul></li>
  <li><a href="#histograma-definição-moderna." id="toc-histograma-definição-moderna." class="nav-link" data-scroll-target="#histograma-definição-moderna."><span class="header-section-number">5.4</span> Histograma, definição moderna.</a></li>
  <li><a href="#estimador-kernel." id="toc-estimador-kernel." class="nav-link" data-scroll-target="#estimador-kernel."><span class="header-section-number">5.5</span> Estimador kernel.</a></li>
  <li><a href="#escolha-automática-da-largura-de-banda" id="toc-escolha-automática-da-largura-de-banda" class="nav-link" data-scroll-target="#escolha-automática-da-largura-de-banda"><span class="header-section-number">5.6</span> Escolha automática da largura de banda</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">5.7</span> </a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://raymz1990.github.io/CE313/edit/main/book/ModuloI/Aula05/index.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://raymz1990.github.io/CE313/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../ModuloI/index.html">Módulo I</a></li><li class="breadcrumb-item"><a href="../../ModuloI/Aula05/index.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimação de Densidades</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimação de Densidades</span></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>De certa forma, problemas de estimação não-paramétrica são extensões de problemas de estimação paramétrica, mas a natureza do primeiro é bem diferente do último. Considere, por exemplo, a situação de observações independentes identicamente distribuídas, digamos <span class="math inline">\(X_1,X_2,\cdots,X_n\)</span>.</p>
<p>Em um problema paramétrico, assumimos que a distribuição de <span class="math inline">\(X_i\)</span> é <span class="math inline">\(F(\cdot;\theta)\)</span>, a qual é totalmente especificada até o vetor de parâmetros <span class="math inline">\(\theta\)</span>; então o problema é essencialmente a estimaçã de <span class="math inline">\(\theta\)</span>. Em um problema não-paramétrico, a distribuição é totalmente desconhecida com, talvez, algumas restriçõs em propriedades gerais e, portanto, é denotada por <span class="math inline">\(F\)</span>.</p>
<p>Aqui consideramos estimadores de <span class="math inline">\(F\)</span> em termos de função de densidade <span class="math inline">\(f\)</span>. A função de densidade tem a vantagem de fornecer uma representação visualmente mais informativa do que a função de distribuição. Por exemplo, o histograma geralmente dá uma ideia aproximada da forma da distribuição. Este último ficou como o único estimador de densidade não paramétrico até 1950. Por essa razão, nossa discussão começará com os histogramas.</p>
<p>Embora o histograma seja usado extensivamente, não é tão frequente que seja necessária uma definição matemática. Uma maneira de defini-lo é através da função de densidade empírica.</p>
<section id="função-de-densidade-empírica." class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="função-de-densidade-empírica."><span class="header-section-number">5.1</span> Função de densidade empírica.</h2>
<blockquote class="blockquote">
<p><strong>Definição</strong>. Seja <span class="math inline">\(f\)</span> a derivada de <span class="math inline">\(F\)</span>, por isso, pode-se escrever como <span class="math display">\[
f(x) = \lim_{h\to 0} \dfrac{F(x+h)-F(x-h)}{2h}\cdot
\]</span> Dizemos então que <span class="math inline">\(\widehat{f}\)</span>, defnido por <span class="math display">\[
\widehat{f}_n(x)=\dfrac{\widehat{F}_n(x+h)-\widehat{F}_n(x-h)}{2h},
\]</span> é o histograma, sendo que <span class="math inline">\(\widehat{F}\)</span>_n é a função de distribuição empírica.</p>
</blockquote>
<p>Um histograma é uma representação gráﬁca da função de probabilidades ou da função de densidade de um conjunto de dados independentes e foi introduzido pela primeira vez por Karl Pearson no artigo Pearson, K. (1895). Contributions to the Mathematical Theory of Evolution. II. Skew Variation in Homogeneous Material. Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences 186: 343-414.</p>
<p>A representação mais comum do histograma é um gráﬁco de barras verticais. A palavra histograma é de origem grega, derivada de duas: histos que pode signiﬁcar testemunha no sentido de aquilo que se vê, como as barras verticais do histograma e da também palavra grega gramma que signiﬁca desenhar, registrar ou escrever.</p>
<p>Para construir um exemplo controlado do gráﬁco de histograma, simulamos uma amostra de tamanho 150 da distribuição normal padrão, com o comando <strong>rnorm</strong> e depois construímosum gráfico colorido, abaixo a esquerda. Posteriormente, acrescentamos a este gráﬁco uma linha com a densidade normal, abaixo a direita.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8476</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>exemplo <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">150</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(exemplo, <span class="at">breaks=</span><span class="dv">12</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">xlab=</span><span class="st">"Dados simulados"</span>, <span class="at">ylab=</span><span class="st">"Frequencia"</span>, <span class="at">main=</span><span class="st">"Histograma"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>h<span class="ot">=</span><span class="fu">hist</span>(exemplo, <span class="at">breaks=</span><span class="dv">10</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">xlab=</span><span class="st">"Dados simulados"</span>, <span class="at">ylab=</span><span class="st">"Frequencia"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="st">"Histograma com a curva normal"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>xfit<span class="ot">=</span><span class="fu">seq</span>(<span class="fu">min</span>(exemplo),<span class="fu">max</span>(exemplo),<span class="at">length=</span><span class="dv">40</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>yfit<span class="ot">=</span><span class="fu">dnorm</span>(xfit,<span class="at">mean=</span><span class="fu">mean</span>(exemplo),<span class="at">sd=</span><span class="fu">sd</span>(exemplo))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>yfit<span class="ot">=</span>yfit<span class="sc">*</span><span class="fu">diff</span>(h<span class="sc">$</span>mids[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">*</span><span class="fu">length</span>(exemplo)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xfit, yfit, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Gráﬁco de histograma para dados simulados.
</figcaption>
</figure>
</div>
</div>
</div>
<p>A ideia é mostrar que o histograma assemelha-se ao gráﬁco da densidade normal, a densidade dos dados.</p>
</section>
<section id="histograma-informalmente" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="histograma-informalmente"><span class="header-section-number">5.2</span> Histograma, informalmente</h2>
<blockquote class="blockquote">
<p><strong>Definição</strong>. Matematicamente o histograma é uma função <span class="math inline">\(m_i\)</span> que conta o número de observações que pertencem a vários intervalos disjuntos, entanto que o gráﬁco do histograma ou simplesmente histograma é uma mera representação desta função. Assim, se <span class="math inline">\(n\)</span> representa o total de observações e <span class="math inline">\(k\)</span> o número de intervalos disjuntos, o histograma satisfaz que <span class="math display">\[
n=\sum_{i=1}^k m_i\cdot
\]</span></p>
</blockquote>
<p>O histograma é um gráﬁco composto por retângulos justapostos em que a base de cada um deles corresponde ao intervalo de classe e a sua altura à respectiva frequência. A construção de histogramas tem caráter preliminar em qualquer estudo e é um importante indicador da distribuição de dados. Pode indicar se uma distribuição aproxima-se de uma densidade normal como pode indicar mistura de densidades, quando os dados apresentam várias modas.</p>
<p>Os histogramas podem ser um mau método para determinar a forma de uma distribuição porque são fortemente inﬂuenciados pelo número de intervalos utilizados. Por exemplo, decidimos gerar 50 amostras da densidade <span class="math inline">\(\chi^2(6)\)</span> e mostramos os gráﬁcos de histogramas correspondentes com 14 e 26 intervalos na Figura 2.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5678</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">rchisq</span>(<span class="dv">50</span>, <span class="at">df=</span><span class="dv">6</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks=</span><span class="dv">14</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Histograma "</span>,chi<span class="sc">^</span><span class="dv">2</span>,<span class="st">"(6)"</span>)), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Frequencia"</span>, <span class="at">xlab=</span><span class="st">"14 intervalos"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">breaks=</span><span class="dv">26</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Histograma "</span>,chi<span class="sc">^</span><span class="dv">2</span>,<span class="st">"(6)"</span>)), </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Frequencia"</span>, <span class="at">xlab=</span><span class="st">"26 intervalos"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Histogramas da distribuição chi² com 6 graus de liberdade. Número de intervalos 14 e 26, respectivamente.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Vejamos agora uma deﬁnição mais clara do histograma.</p>
</section>
<section id="histograma" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="histograma"><span class="header-section-number">5.3</span> Histograma</h2>
<blockquote class="blockquote">
<p><strong>Definição</strong>: Sejam <span class="math inline">\(I_1,\cdots,I_k\)</span> intervalos disjuntos do suporte da função de probabilidade ou de densidade da variável aleatória <span class="math inline">\(X\)</span>. O histograma é deﬁnido por <span class="math display">\[
\widehat{f}_n(x) = \dfrac{m_i}{n|I_i|}, \quad \forall x\in I_i, \;
i=1,\cdots,n,
\]</span> onde <span class="math inline">\(|I_i|\)</span> representa o comprimento do intervalo <span class="math inline">\(i\)</span>, <span class="math inline">\(m_i\)</span> e <span class="math inline">\(n\)</span> como na Deﬁnição 1.</p>
</blockquote>
<p>Foi provado por Robertson (1967) que, dados os intervalos <span class="math inline">\(I_1,I_2,\cdots,I_k\)</span>, o histograma <span class="math inline">\(\widehat{f}_n\)</span> é um estimador de máxima verossimilhança dentre os estimadores expressados como funções simples e semi-contínuas superiormente, isto se o fecho de cada intervalos contiver duas ou mais observações. Os gráﬁcos apresentados nas ﬁguras acima são histogramas também segundo a proposta de Robertson (1967).</p>
<p>Pode-se observar que este estimador tem duas limitações importantes: a dependência do comprimento do intervalo e o fato de o histograma não constituir uma função contı́nua. A primeira destas limitações foi amplamente estudada por Wegman (1975). Ele provou que os pontos extremos de cada intervalo <span class="math inline">\(I_k\)</span> devem ser coincidentes com observações e que, se o número mínimo de observações em cada intervalo aumenta, conforme aumenta o tamanho da amostra, o estimador <span class="math inline">\(\widehat{f}_n\)</span> é consistente.</p>
<p>A segunda limitação importante do histograma, isto é, o fato de ele não constituir uma função contı́nua, incentivou diversos estudos na procura de estimadores contı́nuos da função de densidad.</p>
<section id="cálculo-automático-do-número-de-intervalos-num-histograma" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="cálculo-automático-do-número-de-intervalos-num-histograma"><span class="header-section-number">5.3.1</span> Cálculo automático do número de intervalos num histograma</h3>
<p>Uma questão importante é determinar de maneira automatizada o número de intervalos disjuntos que serão utilizados para a construção do gráﬁco. Uma primeira forma de escolher o número de intervalos foi dada por Sturges (1926) e que constitui a forma padrão no <strong>R</strong>. Conhecida como fórmula de Sturges é dada por</p>
<p><span class="math display">\[
k= [\log_2(n) + 1],
\]</span></p>
<p>isto signiﬁca que o número de intervalos é a parte inteira do logaritmo base 2 do número de observações mais 1.</p>
<p>Outras expressões comumente utilizadas são a fórmula de Scott (Scott, 1979) <span class="math inline">\(h = 3.5s/\sqrt{n}\)</span>, onde <span class="math inline">\(s\)</span> é o desvio padrão amostral e a fórmula de Freedman-Diacconi (Freedman and Diaconis, 1981) <span class="math inline">\(h = 2\mbox{IQR}(x)/ n\)</span>, onde <span class="math inline">\(\mbox{IRQ}\)</span> é a diferença entre o terceiro e o primeiro quantil.</p>
<p>Uma outra forma de definir o histograma é utilizando o estimador empírico da função de distribuição.</p>
</section>
</section>
<section id="histograma-definição-moderna." class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="histograma-definição-moderna."><span class="header-section-number">5.4</span> Histograma, definição moderna.</h2>
<blockquote class="blockquote">
<p><strong>Definição</strong>: Na definição de função de densidade empírica, o parâmetro <span class="math inline">\(h\)</span> é chamado de largura de banda. Podemos escrever o histograma <span class="math inline">\(\widehat{f}_n\)</span>, como, <span class="math display">\[
\widehat{f}_n(x)=\dfrac{1}{2nh}\sum_{i=1}^n
\pmb{1}_{(x-h;x+h)}(X_i)\cdot
\]</span></p>
</blockquote>
<p>Podemos excrever a função de densidade como <span class="math display">\[
f(x)=\lim_{h\to 0} \dfrac{1}{h}\big(F(x+h)−F(x−h)\big),
\]</span> mas não se pode definir daqui o histograma porque esse limite é zero ou infinito e, assim, em algum momento é preciso parar, em outras palavras, não se pode chegar muito perto de zero.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Teorema 5.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Seja <span class="math inline">\(f\)</span> a função de densidade associda à função de distribuição <span class="math inline">\(F\)</span>. Então, com probabilidade 1, <span class="math display">\[
\widehat{f}_n(x)\sim \mbox{Binomial}(n,p),
\]</span> com <span class="math inline">\(p=F(x+h)-F(x-h)\)</span>. Assim, o comportamento assintótico do histograma pode ser derivado da distribuição binomial como <span class="math display">\[
\mbox{E}\big(\widehat{f}_n(x)\big)=\dfrac{F(x+h)-F(x-h)}{2h}
\]</span> e <span class="math display">\[
\mbox{Var}\big( \widehat{f}_n(x)\big)=\dfrac{p(1-p)}{2nh^2}\cdot
\]</span></p>
</div>
</div>
<p><strong>Demonstração.</strong> Exercício,</p>
<p>Deste teorema segue que <span class="math inline">\(\widehat{f}_n(x)\)</span> é um estimador consistente pontual de <span class="math inline">\(f(x)\)</span> quando <span class="math inline">\(h\to 0\)</span> e <span class="math inline">\(nh\to\infty\)</span>. A seguir, o processo de limite é entendido como <span class="math inline">\(h=h_n\)</span>, ou seja, entende-se disto que <span class="math inline">\(h\)</span> não será mais uma quantidade fica e sim uma quantida que depende do tamanho da amostra. A suposição <span class="math inline">\(h=h_n\)</span> dese satisfazer as condições do Teorema 1, de maneira que, <span class="math inline">\(h_n\to 0\)</span> e <span class="math inline">\(nh_n\to\infty\)</span>. Estas condições podem ser interpretadas como se fosse necessário <span class="math inline">\(h_n\)</span> ir a zero, mas não muito rápido. Isso é exatamente o que temos especulado, exceto que agora temos a taxa exata de convergência, que pode ser escrita como <span class="math inline">\(h_n=o(n)\)</span>.</p>
<p>Exemplo 1: Dados simulados.</p>
<p>Utilaremos 50 dados simulados da distribuíão <span class="math inline">\(N(0,1)\)</span>, com isso mostraremos o histograma destes 50 dados utilizando duas formas diferentes de encontrarmos uma expressão para <span class="math inline">\(h_n\)</span>, a chamada largura de banda.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1340</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">"Sturges"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(); <span class="fu">grid</span>()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">"Scott"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(); <span class="fu">grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Neste exemplo utilizamos duas formas de escolher a largura de banda <span class="math inline">\(h_n\)</span> dentre três diferentes possibilidades programadas na função <strong>hist</strong>. Por padrão escolhe-se <strong>breaks = “Sturges”</strong>, proposto por Sturges (1929), o qual sugere que</p>
<p><span class="math display">\[
h_n=\dfrac{X_{(n)}-X_{(1)}}{1+3.322 \ln(n)}\cdot
\]</span></p>
<p>A segunda situação indica que se os dados provêm da distribuição Normal temos que <span class="math inline">\(h_n=3.49sn^{−1/3}\)</span> sendo <span class="math inline">\(s\)</span> o desvio padrão estimado. Esta proposta deve-se à Scott (1979). Embora o histograma é um estimador consistente quando <span class="math inline">\(h_n\to 0\)</span> e <span class="math inline">\(nh_n\to\infty\)</span>, verifica-se que se pode fazer melhor. A melhoria também é motivada por uma preocupação prática: o histograma não é uma função suave, uma propriedade que se pode esperar que qualquer função de densidade real tenha.</p>
</section>
<section id="estimador-kernel." class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="estimador-kernel."><span class="header-section-number">5.5</span> Estimador kernel.</h2>
<blockquote class="blockquote">
<p><strong>Definição</strong>: O estimador kernel da função de densidade é dado por <span class="math display">\[
\widehat{f}_n(x)=\dfrac{1}{nh_n}\sum_{i=1}^n
K\left(\dfrac{x-X_i}{h_n}\right),
\]</span> onde <span class="math inline">\(K(\cdot)\)</span> é uma função conhecida como kernel.</p>
</blockquote>
<p>É tipicamente assumido que <span class="math inline">\(K\)</span> seja não-negativa, simétrica em torno de zero e satisfaz <span class="math inline">\(\int K(u)\mbox{d}u=1\)</span>. Claro que o histograma é um caso especial do estimador do kernel se <span class="math inline">\(K\)</span> for escolhido como a função de densidade <span class="math inline">\(\mbox{Uniforme}(−1,1)\)</span>. O último não é uma função suave e é por isso que o histograma não é suave; mas escolhendo <span class="math inline">\(K\)</span> como uma função suave, tem-se um estimador de <span class="math inline">\(f\)</span> que seja suave. Por exemplo, escolhendo a função de densidade <span class="math inline">\(N(0,1)\)</span>, temos por resultado o conhecido como kernel Gaussiano e assim também se utilizamos a densidade de densidade <span class="math inline">\(\mbox{Beta}\)</span> simétrica, dada por <span class="math display">\[
K(u)=\dfrac{\Gamma(\nu+3/2)}{\Gamma(1/2)\Gamma(\nu+1)}(1-u^2)^\nu, \quad
-1&amp;lt;u&amp;lt;-1\cdot
\]</span> e <span class="math inline">\(K(u)=0\)</span> caso contrário. Os casos especiais <span class="math inline">\(\nu=0,1,2,3\)</span> correspondem às funções kernel uniforme, <em>Epanechnikov</em>, <em>biweight</em> e <em>triweight</em>, respectivamente.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>kernels <span class="ot">=</span> <span class="fu">eval</span>(<span class="fu">formals</span>(density.default)<span class="sc">$</span>kernel)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (<span class="fu">density</span>(<span class="dv">0</span>, <span class="at">bw =</span> <span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">"Diferentes kernel em R"</span>); <span class="fu">grid</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(kernels)) <span class="fu">lines</span>(<span class="fu">density</span>(<span class="dv">0</span>, <span class="at">bw =</span> <span class="dv">1</span>, <span class="at">kernel =</span>  kernels[i]), <span class="at">col =</span> i)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="fl">1.0</span>,<span class="fl">0.2</span>, <span class="at">legend =</span> kernels, <span class="at">col =</span> <span class="fu">seq</span>(kernels), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> .<span class="dv">8</span>, <span class="at">y.intersp =</span> <span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>h.f <span class="ot">=</span> <span class="fu">sapply</span>(kernels, <span class="cf">function</span>(k) <span class="fu">density</span>(<span class="at">kernel =</span> k, <span class="at">give.Rkern =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>h.f <span class="ot">=</span> (h.f[<span class="st">"gaussian"</span>] <span class="sc">/</span> h.f)<span class="sc">^</span> .<span class="dv">2</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> <span class="fu">bw.SJ</span>(x) <span class="co"># escolha automática</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> bw), <span class="at">main =</span> <span class="st">"Larguras de banda equivalentes"</span>); <span class="fu">grid</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(kernels)) <span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> bw, <span class="at">adjust =</span> h.f[i], <span class="at">kernel =</span> kernels[i]), <span class="at">col =</span> i)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">55</span>, <span class="fl">0.035</span>, <span class="at">legend =</span> kernels, <span class="at">col =</span> <span class="fu">seq</span>(kernels), <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="escolha-automática-da-largura-de-banda" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="escolha-automática-da-largura-de-banda"><span class="header-section-number">5.6</span> Escolha automática da largura de banda</h2>
<p>Um problema prático importante na estimação de densidades via kernel é como escolher a largura de banda <span class="math inline">\(h_n\)</span> de forma automática. Note que, dadas condições como <span class="math inline">\(h_n\to 0\)</span> e <span class="math inline">\(nh_n\to\infty\)</span>, ainda existem muitas opções para <span class="math inline">\(h_n\)</span>. Então, de certo modo, a ordem de convergência ou divergência não resolve o problema. Uma solução para esse problema é conhecida como compensação de viés-variância. Antes de entrarmos nos detalhes, vamos primeiro apressentar um resultado em relação ao viés assintótico do estimador kernel. Aqui, o viés é definido como</p>
<p><span class="math display">\[
\mbox{viés}\big( \widehat{f}_n(x)\big)=\mbox{E}\big(
\widehat{f}_n(x)\big)-f(x),
\]</span> para todo <span class="math inline">\(x\in\mathbb{R}\)</span>.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Teorema 5.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Seja <span class="math inline">\(f\)</span> uma função de densidade contínua e limitada. Então, o viés do estimador kernel de desnidade converge a zero quando <span class="math inline">\(h_n\to 0\)</span>, para todo <span class="math inline">\(x\)</span>,</p>
</div>
</div>
<div>
<p><strong>Demonstração.</strong> <span class="math display">\[
\begin{array}{rcl}
\mbox{E}\big(\widehat{f}_n(x) \big) &amp;amp; = &amp;amp; \displaystyle
\dfrac{1}{n}\sum_{i=1}^n \dfrac{1}{h_n} \int
K\left(\dfrac{x-u}{h_n}\right)f(u)\mbox{d}u \\
&amp;amp; = &amp;amp; \displaystyle \int K(u)f(x-h_nu)\mbox{d}u \, = \, f(x) +
\int K(u)\big( f(x-h_nu)-f(x)\big) \mbox{d}u\cdot
\end{array}
\]</span> Utilizando então o Teorema da Convergência Dominada completa-se a demonstração.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Teorema 5.3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suponhamos que <span class="math inline">\(f\)</span> seja contínua três vezes diferenciável, com terceira derivada limitada na vizinhança de <span class="math inline">\(x\)</span> e <span class="math inline">\(K\)</span>, função kernel, satisfazendo que <span class="math display">\[
\int K^2(u)\mbox{d}u&amp;lt; \infty \quad \mbox{e} \quad \int |u^3|
K(u)\mbox{d}u &amp;lt; \infty \cdot
\]</span> Se <span class="math inline">\(h_n\to 0\)</span>, quando <span class="math inline">\(n\to\infty\)</span>, temos que <span class="math display">\[
\mbox{viés}\big(
\widehat{f}_n(x)\big)=\dfrac{h_n^2}{2}f&amp;#39;&amp;#39;(x)\int u^2
K(u)\mbox{d}u + o(h_n^2)\cdot
\]</span> Se, além disso, <span class="math inline">\(bh_n\to\infty\)</span> quando <span class="math inline">\(n\to\infty\)</span>, temos <span class="math display">\[
\mbox{Var}\big(\widehat{f}_n(x)\big)=\dfrac{f(x)}{nh_n}\int
K^2(u)\mbox{d}u+o(1/nh_n)\cdot
\]</span></p>
</div>
</div>
<p><strong>Demonstração.</strong> A demonstração é baseada na expansão de Taylor, <span class="math display">\[
f(x-h_n u)=f(x)-h_n u f&amp;#39; (x)+\dfrac{h_n^2 u^2}{2}
f&amp;#39;&amp;#39;(x)-\dfrac{h_n^3 u^3}{6}f&amp;#39;&amp;#39;&amp;#39; (\epsilon),
\]</span></p>
<p>sendo que <span class="math inline">\(\epsilon\)</span> fica entre <span class="math inline">\(x−h_n u\)</span> e <span class="math inline">\(x\)</span>. Os detalhes são deixados como um exercício.</p>
<p>Uma medida de precisão do estimador é o erro quadrático médio (EQM), dado por <span class="math display">\[
\mbox{EQM}\big(
\widehat{f}_n(x)\big)=\mbox{E}\big(\widehat{f}_n(x)-f(x)\big)^2\cdot
\]</span></p>
<p>É fácil mostrar que o EQM combina o viés e a variância de tal maneira que</p>
<p><span class="math display">\[
\mbox{EQM}\big(
\widehat{f}_n(x)\big)=\mbox{viés}\big(\widehat{f}_n(x)\big)^2+\mbox{Var}\big(\widehat{f}_n(x)\big)\cdot
\]</span> Vemos que, sob as condições <span class="math inline">\(h_n\to
0\)</span> e <span class="math inline">\(nh_n\to\infty\)</span> e, se ignorarmos os termos de baixa ordem, temos</p>
<p><span class="math display">\[
\mbox{EQM}\big( \widehat{f}_n(x)\big) \approx \dfrac{h_n^4}{4}\big(
f&amp;#39;&amp;#39;(x)\big)^2\tau^4+\dfrac{f(x)}{nh_n}\gamma^2,
\]</span></p>
<p>onde <span class="math inline">\(\tau^2=\int u^2
K(u)\mbox{d}u\)</span> e <span class="math inline">\(\gamma^2=∫
K^2(u)\mbox{d}u\)</span>. O termo à direita da expressão acima é minimizada quando</p>
<p><span class="math display">\[
h_n=\left( \dfrac{\gamma^2 f(x)}{\tau^4 \big(
f&amp;#39;&amp;#39;(x)\big)^2}\right)^{1/5}n^{-1/5}\cdot
\]</span></p>
<p>Note ainda que a expressão acima não é a solução ideal, isso porque <span class="math inline">\(f\)</span> é desconhecida na prática. No entanto, dá-nos pelo menos alguma ideia sobre a taxa ideal de convergência a zero, sendo esta <span class="math inline">\(h_n=O(n^{-1/5})\)</span>.</p>
<p>Quando <span class="math inline">\(f\)</span> é desconhecida, uma abordagem natural seria substituí-lo por um estimador e, assim, obter uma largura de banda ideal estimada. Uma complicação é que a largura de banda ideal depende de <span class="math inline">\(x\)</span> mas, idealmente, gostaríamos de usar uma largura de banda que funcionasse para diferentes <span class="math inline">\(x\)</span> dentro de um certo intervalo, se não todos os <span class="math inline">\(x\)</span>.</p>
<p>Para obter uma largura de banda ideal que não depende de <span class="math inline">\(x\)</span>, integramos os dois lados da expressão do EQM em relação a <span class="math inline">\(x\)</span>. Isto nos leva a</p>
<p><span class="math display">\[
\int \mbox{EQM}\big(\widehat{f}_n(x)\big)\approx \dfrac{\tau^4
h_n^4}{4}\int
\big(f&amp;#39;&amp;#39;(x)\big)^2\mbox{d}x+\dfrac{\gamma^2}{nh_n}\int
f(x)\mbox{d}x = \dfrac{\tau^4 \theta^2 h_n^4}{4}+\dfrac{\gamma^2}{nh_n},
\]</span></p>
<p>com <span class="math inline">\(\theta^2=\displaystyle \int \big( f&amp;#39;&amp;#39;(x)\big)^2 \mbox{d}x\)</span>. Pelo mesmo argumento, o lado direito acima é minimizado quando</p>
<p><span class="math display">\[
h_n=\left( \dfrac{\gamma^2}{\tau^4\theta^2}\right)^{1/5}n^{-1/5}\cdot
\]</span> Desta vez, o <span class="math inline">\(h_n\)</span> ideal não depende de <span class="math inline">\(x\)</span>. Além disso, a integral do EQM ou o IEQM mínimo é dado por</p>
<p><span class="math display">\[
\mbox{IEQM}=\int
\mbox{EQM}\big(\widehat{f}_n(x)\big)\mbox{d}x=\dfrac{5}{4}\big(\tau\gamma^2\big)^{4/5}\theta^{2/5}n^{-4/5}\cdot
\]</span></p>
<p>Uma implicação do resultado acima é a seguinte. Note que o IEQM depende do kernel <span class="math inline">\(K\)</span> através de <span class="math inline">\(c_K=\big(\tau\gamma^2\big)^{4/5}\)</span>. Mostrou-se que para os kernels comumente usados, tais como aqueles listados, o desempenho dos estimadores de kernel correspondentes é quase o mesmo em termos dos valores de <span class="math inline">\(c_K\)</span>.</p>
<p>Voltando ao problema sobre a estimação da largura de banda ideal, vemos que tudo o que precisamos é encontrar um estimador consistente de <span class="math inline">\(\theta^2\)</span>. Se <span class="math inline">\(f\)</span> é a função de densidade da distribuição normal com desvio padrão <span class="math inline">\(\sigma\)</span>, então pode ser mostrado que <span class="math inline">\(\theta^2=3/8\sqrt{\pi}\sigma^5\)</span>. Naturalmente, se alguém souber que <span class="math inline">\(f\)</span> é normal, então a estimação da densidade não-paramétrica não seria necessária, porque um método paramétrico provavelmente seria melhor. Em geral, pode-se expandir <span class="math inline">\(f\)</span> em torno da densidade gaussiana usando a expansão de Edgeworth.</p>
<p>Utilizando a abordagem acima, Hjort and Jones (1996) obteveram o seguinte estimador ótimo para a largura de banda <span class="math display">\[
\widehat{h}_n=\widehat{h}_0\left(
1+\dfrac{35}{48}\widehat{\gamma}_4+\dfrac{35}{32}\widehat{\gamma}^2_3+\dfrac{385}{1024}\widehat{\gamma}^2_4\right)^{-1/2},
\]</span> onde <span class="math inline">\(\widehat{h}_0\)</span> é a estimativa ideal da largura de banda assumindo que <span class="math inline">\(f\)</span> é normal, isto é, com <span class="math inline">\(\theta^2\)</span> substituído por <span class="math inline">\(3/8\sqrt{\pi}\sigma^5\)</span> ou mais explicitamente</p>
<p><span class="math display">\[
\widehat{h}_0=1.06\left( \dfrac{\widehat{\sigma}}{n^{1/5}}\right)\cdot
\]</span></p>
<p>Chamamos <span class="math inline">\(\widehat{h}_0\)</span>, a largura de banda da linha de base e <span class="math inline">\(\widehat{\sigma}^2\)</span>, a variância amostral, dada por</p>
<p><span class="math display">\[
\widehat{\sigma}^2 = \dfrac{1}{n-1}\sum_{i=1}^n
(x_i-\overline{x})^2\cdot
\]</span> Além disso, 4_3$ e <span class="math inline">\(\widehat{\gamma}_4\)</span> são os estimadores dos coefcientes de assimetria e curtose amostrais, respectivamente, dados por <span class="math display">\[
\widehat{\gamma}_3=\dfrac{1}{(n-1)\widehat{\sigma}^3}\sum_{i=1}^n
(x_i-\overline{x})^3
\]</span> e</p>
<p><span class="math display">\[
\widehat{\gamma}_4=\dfrac{1}{(n-1)\widehat{\sigma}^4}\sum_{i=1}^n
(x_i-\overline{x})^4-3\cdot
\]</span> Os procedimentos de estimação de densidade mostrados até o momento foram implementados na função <strong>density</strong>.</p>
</div></section>
<section id="section" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="section"><span class="header-section-number">5.7</span> </h2>
<p>Exemplo 2: Estimador kernel de densidade em dados simulados.</p>
<p>Utilizaremos os dados simulados da distribuíão <span class="math inline">\(N(0,1)\)</span> no exemplo anterior. Mostraremos o histograma e o estimador kernel da função de densidade.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">"Sturges"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(); <span class="fu">grid</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> <span class="st">"nrd0"</span>), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">"Scott"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(); <span class="fu">grid</span>()</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> <span class="st">"bcv"</span>), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in bw.bcv(x): mínimo ocorreu em uma das extremidades do intervalo</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Houveram outras abordagens para a seleção da largura de banda ótima, incluindo o método de validação cruzada.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../ModuloI/Aula04/index.html" class="pagination-link  aria-label=" &lt;span="" de="" distribuição="" empírica&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Função de Distribuição Empírica</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../ModuloII/index.html" class="pagination-link" aria-label="Módulo I">
        <span class="nav-page-text">Módulo I</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Estatística 2023-2026</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://raymz1990.github.io/CE313/edit/main/book/ModuloI/Aula05/index.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://raymz1990.github.io/CE313/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>